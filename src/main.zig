const std = @import("std");
const tls = @import("client_hello.zig");

pub fn main() !void {
    var arena = std.heap.ArenaAllocator.init(std.heap.page_allocator);
    defer arena.deinit();
    const allocator = arena.allocator();

    const str_hello = "010003fc03034a70c51c8a2384b2b4f26471d551d528ec8e362ac9e4723496e7c51c90d39b3020f34a717bc8079cfb1deef7710295c7bcc742fade313cea63510bc297d2a1184c0020dada130113021303c02bc02fc02cc030cca9cca8c013c014009c009d002f003501000393baba0000fe0d00fa0000010001390020c769493aece520ac60f4ec93efdd224a624f1605cb3db161ee5845f5ef4b096f00d08762d9fe52e3ab09094f1c88db8173c9a3d3ad40600dcd64b8d17d5147f52eaeb78b2c30a9a99f8b328ff7660f205e9d160616b468c83c7757403911fa1627ebd9ad48159608c79e66b6be97d3fb30158382d13ee8281d346a99af35f5f035997a0737e417abc9e603d7815c39b0e85f49eae956ba4846bdc03b09a11c3e9f73ca619a7f9e52e3140af47b43df0e41d16d66ebf0023ec2be62d19374e418ea4cd6f70afc1069a0f5638d30839f27106c4b2180fbbcac8713e09d2fe1d3618251dd45c209d5bb952d2f34289a9013f7c40000001800160000136163636f756e74732e676f6f676c652e636f6d000b000201004469000500030268320010000e000c02683208687474702f312e31000500050100000000002b0007065a5a03040303002d00020101ff01000100000a000a00088a8a001d00170018000d0012001004030804040105030805050108060601001700000023000000120000001b00030200020033002b00298a8a000100001d0020f31fbb2a14ce97db8b2490754251053a7152d21cf684441d51a6691365a10f0e5a5a000100002901c601a1019b026a098ecdb087b933a0a0ca0a1736f7471353321665deb39165ca1e8e540bee45b9f812d8d273fbfe6646b777491d7132698d3a82cebc75c6da54c433e584d1121f6e9b317185aa7c49db7a0c9cb1b29556ec2c89a9ef91d26fd6779179a6d7dcae7dbf9e213688acf59fbcfbfbfdf18d2afb677f5ab73f8a90d56fa6e8dcbce3af08f7c1b31f404b54271e0b5019b121c7dfbfda7d8dd61306cd12fc20458186469d9cda93ce2a53e9b4b129d92567358cd4f36203766ce731c1097e72893ea7e7ff5441ec93b726851f5a5ab0d37c2c602489e6c4e2e9d580a55245508d8e75d7790206567317642ab3a5891e1314fd7074c65ec76d62f0079453e472a320ce6083fa26f68ac092ac9735e907b8e3a62234ddef048409b850ce7fb48c2dc44659e3c5f5a183315f9561253d1768c24d754fe0ffdcc4fac485916d1ee17a031755c05cba5e22497c5d63a797ab3a87c2744ff28a2e3ef41727187daef8df9d8ebd35bfb4d91d64551b8a07ea491a234e5a6c267b8fa2a945c40467765bc9ee0401fc068ad1170e68a1fc4e30b93398425255be6abd4c157d5fd1c926409c0021202d3fd5f133762609f75593425e6b7d01cd916162742b7972923d656a2c472529";
    var raw_hello: [str_hello.len]u8 = undefined;
    _ = try std.fmt.hexToBytes(&raw_hello, str_hello);

   const hello = try tls.unmarshalClientHello(allocator, &raw_hello);
   std.debug.print("{any}\n", .{hello.extensions});
}
