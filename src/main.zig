const std = @import("std");
const tls = @import("client_hello.zig");
const ja3 = @import("ja3.zig");

pub fn main() !void {
    var arena = std.heap.ArenaAllocator.init(std.heap.page_allocator);
    defer arena.deinit();
    const allocator = arena.allocator();

    const str_hello = "010003410303b923497ba384aafa6f0928ea902acf5ba5665216e2116518a4a01281184893d1208e13b8d19dcd1d1da8c0cd99d4a0fd368b7fb66eed98c2ff642576fbdf08dbaf00201a1a130113021303c02bc02fc02cc030cca9cca8c013c014009c009d002f0035010002d89a9a0000002b0007066a6a0304030300230000000d001200100403080404010503080505010806060100170000000b000201000010000e000c02683208687474702f312e310033002b00296a6a000100001d0020550c1adf85f58a06dc6fba70b12d6adbc38fc6f403d79f23892b0c958c8eee640000001800160000137777772e72617069647461626c65732e636f6d446900050003026832002d00020101fe0d011a00000100015b0020a9839dba528bc0d5a5aa5a100e4a9ead4a1308cad54ebe5631774dfcbc0c437200f0bb494b55218d20fb78d05777b7d8afb7ad3f713ec447fbebbdb9aae995cd3cd5538b86e01dc210dc2c1b53c1acc4595f5e9db1a0bd8e9fde3c762210d41194ed2cd7730c78d4583d474b60cb60e91f5e5335904a845f48620db79cbf6b1a9b1e379f1a3ba031051b43dbafaa192fc25fb1bba3aaba24905bf45499dd4d928a9ce01bb2d573e0bd6eeb1bad94783d8be218df07c2a7a902b15c5d67f8deab1cc02b626ea24b6d1c7c46f89873535d6234f4d147e042075fa6cbaa47a1325e464e26d43033bafa11fd00b3b36f7903500c926bee3dee508009efec6e48ebabbf287d9579948554f0521e2538e5cb28114c001b0003020002000500050100000000000a000a00086a6a001d0017001800120000ff010001001a1a000100002900eb00c600c09d7cce3ad23e09e524afbbdd14447540cc9242d315f4bc69a184b9dbfc61add0cea3da621c3ca3b7c709c9b5ab3bb94a52cc665c9b6e3507f09de450c39e85ff8416d4877b2744b6d2cac0566a888e313eca6069e4caaee129e70cbf4d5a24454ea5297e36d31dab58fa8728208fe9cca56a750eb6bc4977fde2dc22be08499bcaf7d208d0e9e1efea945a0d82950b4de17ea8a59750c44a957d81bedc96cce5f4946a1bcef12beadd4b23ec973755c24b3f1ad9c6f7425caf7b805d88022be2743b26a1002120f2ef1a09a6337785f67120eec85a2935eef2ecebae72bd9169527b20db2c01f7";
    var raw_hello: [str_hello.len]u8 = undefined;
    _ = try std.fmt.hexToBytes(&raw_hello, str_hello);

   var hello = try tls.unmarshalClientHello(allocator, &raw_hello);
   std.debug.print("{any}\n", .{try hello.getExtension(tls.SupportedVersionsExt, allocator)});
   std.debug.print("{s}\n", .{try ja3.fromClientHello(allocator, hello)});
}